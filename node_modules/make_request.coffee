http = require('http')

makeRequest = (json, dest_port=8000) ->
  #setup
  body = JSON.stringify(json)
  options = {host:'localhost', port:dest_port, path:'/', method: 'POST', headers: {
    "Content-Type": "application/json",
    "Content-Length": body.length}}
  request_cb = (r)->
    r.on('data', (d)->
      console.log("post ok"))
  error_cb = (e)->
    console.log('error posting: '+e.json)
  #write json and close stream
  request = http.request(options, request_cb).on('error', error_cb)
  request.end(body)

module.exports = makeRequest
